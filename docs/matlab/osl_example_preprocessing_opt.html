---
layout: matlab_wrapper
title: osl_example_preprocessing_opt
resource: true
categories: examples
---

<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <title>osl_example_preprocessing_opt</title><meta name="generator" content="MATLAB 9.0"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2017-04-05"><meta name="DC.source" content="osl_example_preprocessing_opt.m"></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">SETUP THE MATLAB PATHS</a></li><li><a href="#3">INITIALISE GLOBAL SETTINGS FOR THIS ANALYSIS</a></li><li><a href="#4">SETUP OPT</a></li><li><a href="#5">LOOK AT OPT SETTINGS</a></li><li><a href="#6">LOOK AT OPT SUB-SETTINGS</a></li><li><a href="#7">RUN OPT</a></li><li><a href="#8">RESULTS</a></li></ul></div><pre class="codeinput"><span class="comment">%%%%%%%%%%%%%%%%%%</span>
<span class="comment">% This is a TEMPLATE script for running the OHBA recommended preprocessing</span>
<span class="comment">% pipeline on Elekta-Neuromag data (a very similar pipeline will work on</span>
<span class="comment">% CTF data as well) using OPT. It works through the following steps:</span>
<span class="comment">%</span>
<span class="comment">% You'll need to alter (at the very least) the settings in:</span>
<span class="comment">% datadir, fif_files, spm_files, structurals_files</span>

<span class="comment">%%%%%%%%%%%%%%%%%%</span>
</pre><h2 id="2">SETUP THE MATLAB PATHS</h2><p>make sure that fieldtrip and spm are not in your matlab path</p><pre class="codeinput">OSLDIR = getenv(<span class="string">'OSLDIR'</span>);

<span class="comment">%osldir = '/Users/andrew/Software/Matlab/osl2.0';</span>

<span class="comment">%addpath(osldir);</span>
osl_startup();

<span class="comment">%%%%%%%%%%%%%%%%%%</span>
</pre><pre class="codeoutput">Warning: Duplicate directory name:
/Applications/MATLAB_R2016a.app/toolbox/stateflow/stateflow 
</pre><h2 id="3">INITIALISE GLOBAL SETTINGS FOR THIS ANALYSIS</h2><pre class="codeinput"><span class="comment">% directory where the data is:</span>
datadir = fullfile(osldir,<span class="string">'example_data'</span>,<span class="string">'preproc_example'</span>,<span class="string">'automatic_opt'</span>);


<span class="comment">% Set up the list of subjects and their structural scans for the analysis</span>
clear <span class="string">raw_fif_files</span> <span class="string">input_files</span> <span class="string">spm_files</span> <span class="string">structural_files</span>;

<span class="comment">% Specify a list of the existing raw fif files for subjects for input into</span>
<span class="comment">% Maxfilter.</span>
<span class="comment">% Note that here we only have 1 subject, but more generally there would be</span>
<span class="comment">% more than one, e.g.:</span>
<span class="comment">% raw_files{1}=[testdir '/fifs/sub1_face_sss'];</span>
<span class="comment">% raw_files{2}=[testdir '/fifs/sub2_face_sss'];</span>
<span class="comment">% etc...</span>
<span class="comment">% OR</span>
<span class="comment">% Specify a list of the input files to be converted into SPM</span>
<span class="comment">% Note that here we only have 1 subject, but more generally there would be</span>
<span class="comment">% more than one, e.g.:</span>
<span class="comment">% fif_files{1}=[testdir '/fifs/sub1_face_sss'];</span>
<span class="comment">% fif_files{2}=[testdir '/fifs/sub2_face_sss'];</span>
<span class="comment">% etc...</span>

raw_fif_files{1}=[datadir <span class="string">'/fifs/loc_S02.fif'</span>];
input_files{1}=[datadir <span class="string">'/fifs/loc_S02_sss1.fif'</span>];
spm_files{1}=[datadir <span class="string">'/spm_files/loc_S02'</span>];

<span class="comment">% Setup a list of existing structural files, in the same order as spm_files and fif_files:</span>
<span class="comment">% Note that here we only have 1 subject, but more generally there would be</span>
<span class="comment">% more than one.</span>
structural_files{1}=[datadir <span class="string">'/structs/anat.nii'</span>]; <span class="comment">% leave empty if no .nii structural file available</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</pre><h2 id="4">SETUP OPT</h2><pre class="codeinput">opt=[];

<span class="comment">%%%%</span>
<span class="comment">% required inputs</span>

<span class="comment">%opt.raw_fif_files=raw_fif_files;</span>
opt.input_files=input_files;
<span class="comment">%opt.spm_files=spm_files;</span>

opt.datatype=<span class="string">'neuromag'</span>;

<span class="comment">%%%%</span>
<span class="comment">% optional inputs</span>

opt.dirname=[datadir <span class="string">'/practical_badseg_africa.opt'</span>]; <span class="comment">% directory opt settings and results will be stored</span>

<span class="comment">% maxfilter settings</span>
opt.maxfilter.do=0; <span class="comment">% here we are going to skip the double maxfilter call as this has been run already for us</span>

<span class="comment">% africa settings</span>
<span class="comment">% RATHER NOT!!!!</span>
opt.africa.do=0;
opt.africa.ident.artefact_chans={<span class="string">'ECG'</span>,<span class="string">'EOG'</span>}; <span class="comment">% artefact channels</span>
opt.africa.ident.mains_kurt_thresh=0.5;

<span class="comment">% highpass filter settings</span>
opt.highpass.do=0;

<span class="comment">% bad segments settings</span>
opt.bad_segments.do=0;

<span class="comment">% Epoching settings</span>
<span class="comment">%</span>
<span class="comment">% Here the epochs are set to be from -1s to +2s relative to triggers</span>
<span class="comment">% in the MEG data.</span>
opt.epoch.do=1;
opt.epoch.time_range = [-1 2]; <span class="comment">% epoch end in secs</span>
opt.epoch.trialdef(1).conditionlabel = <span class="string">'StimLRespL'</span>;
opt.epoch.trialdef(1).eventtype = <span class="string">'STI101_down'</span>;
opt.epoch.trialdef(1).eventvalue = 11;
opt.epoch.trialdef(2).conditionlabel = <span class="string">'StimLRespR'</span>;
opt.epoch.trialdef(2).eventtype = <span class="string">'STI101_down'</span>;
opt.epoch.trialdef(2).eventvalue = 16;
opt.epoch.trialdef(3).conditionlabel = <span class="string">'StimRRespL'</span>;
opt.epoch.trialdef(3).eventtype = <span class="string">'STI101_down'</span>;
opt.epoch.trialdef(3).eventvalue = 21;
opt.epoch.trialdef(4).conditionlabel = <span class="string">'StimRRespR'</span>;
opt.epoch.trialdef(4).eventtype = <span class="string">'STI101_down'</span>;
opt.epoch.trialdef(4).eventvalue = 26;
opt.epoch.trialdef(5).conditionlabel = <span class="string">'RespLRespL'</span>; <span class="comment">%L but</span>
opt.epoch.trialdef(5).eventtype = <span class="string">'STI101_down'</span>;
opt.epoch.trialdef(5).eventvalue = 13;
opt.epoch.trialdef(6).conditionlabel = <span class="string">'RespLRespR'</span>;
opt.epoch.trialdef(6).eventtype = <span class="string">'STI101_down'</span>;
opt.epoch.trialdef(6).eventvalue = 19;
opt.epoch.trialdef(7).conditionlabel = <span class="string">'RespRRespL'</span>; <span class="comment">% L but press</span>
opt.epoch.trialdef(7).eventtype = <span class="string">'STI101_down'</span>;
opt.epoch.trialdef(7).eventvalue = 23;
opt.epoch.trialdef(8).conditionlabel = <span class="string">'RespRRespR'</span>;
opt.epoch.trialdef(8).eventtype = <span class="string">'STI101_down'</span>;
opt.epoch.trialdef(8).eventvalue = 29;

<span class="comment">% coreg settings</span>
opt.coreg.do=0; <span class="comment">% not doing coreg here - although normally you would if you want to do subsequent analyses in source space</span>

<span class="comment">% outliers settings</span>
opt.outliers.do=1;

<span class="comment">%%%%</span>
<span class="comment">% setup settings</span>

opt=osl_check_opt(opt);

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</pre><pre class="codeoutput">Using opt.input_files as input
Warning: opt.datatype is neuromag, Will assume that data has been maxfiltered
and will set opt.africa.used_maxfilter=1 
</pre><h2 id="5">LOOK AT OPT SETTINGS</h2><pre class="codeinput">disp(<span class="string">'opt settings:'</span>);
disp(opt);

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</pre><pre class="codeoutput">opt settings:
           datatype: 'neuromag'
      raw_fif_files: []
        input_files: {1x1 cell}
          spm_files: []
    input_file_type: 'input_files'
     sessions_to_do: 1
            dirname: '/Applications/osl/example_data/preproc_example/autom...'
         modalities: {2x1 cell}
      cleanup_files: 1
            convert: [1x1 struct]
          maxfilter: [1x1 struct]
         downsample: [1x1 struct]
           highpass: [1x1 struct]
              mains: [1x1 struct]
       bad_segments: [1x1 struct]
             africa: [1x1 struct]
              epoch: [1x1 struct]
           outliers: [1x1 struct]
              coreg: [1x1 struct]
       osl2_version: 'osl2.0.2'

</pre><h2 id="6">LOOK AT OPT SUB-SETTINGS</h2><pre class="codeinput">disp(<span class="string">'opt.maxfilter settings:'</span>);
disp(opt.maxfilter);

disp(<span class="string">'opt.downsample settings:'</span>);
disp(opt.downsample);

disp(<span class="string">'opt.africa settings:'</span>);
disp(opt.africa);

disp(<span class="string">'opt.highpass settings:'</span>);
disp(opt.highpass);

disp(<span class="string">'opt.epoch settings:'</span>);
disp(opt.epoch);

disp(<span class="string">'opt.outliers settings:'</span>);
disp(opt.outliers);

disp(<span class="string">'opt.coreg settings:'</span>);
disp(opt.coreg);

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</pre><pre class="codeoutput">opt.maxfilter settings:
                   remote_port: 0
                            do: 0
                        do_sss: 1
    do_remove_badchans_pre_sss: 1
          max_badchans_pre_sss: 10
         movement_compensation: 1
                trans_ref_file: []
            temporal_extension: 0
                   maxfilt_dir: '/neuro/bin/util'
                    bad_epochs: {[]}
                      cal_file: 0
                      ctc_file: 0

opt.downsample settings:
      do: 1
    freq: 250

opt.africa settings:
                todo: [1x1 struct]
    precompute_topos: 1
      used_maxfilter: 1
               ident: [1x1 struct]

opt.highpass settings:
        do: 0
    cutoff: 0.1000

opt.epoch settings:
              do: 1
      time_range: [-1 2]
    timing_delay: 0
        trialdef: [1x8 struct]

opt.outliers settings:
                     do: 1
    outlier_measure_fns: {'min'  'std'}
             wthresh_ev: [2x1 double]
           wthresh_chan: [2x1 double]

opt.coreg settings:
              do: 0
    useheadshape: 1
             mri: {''}
       use_rhino: 1
     forward_meg: 'Single Shell'
       fid_label: [1x1 struct]

</pre><h2 id="7">RUN OPT</h2><pre class="codeinput">opt=osl_run_opt(opt);

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</pre><pre class="codeoutput">Using opt.input_files as input
Warning: Directory already exists. 
Warning: Directory already exists. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%  STARTING LOOP OVER SESSIONS  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%  RUNNING OPT ON SESS = 1  %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%  Input file: /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif  %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%  CONVERT INPUT DATA, SESS = 1  %%%%%%%%%%%%%%%%%%%%%%%

SPM12: spm_eeg_convert_4osl (v6190)                18:07:44 - 05/04/2017
========================================================================

SPM12: spm_eeg_convert_4osl (v6190)                18:07:44 - 05/04/2017
========================================================================
	306 MEG channel locations transformed
Reading /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif ...
Opening raw data file /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif...
	Range : 73000 ... 457999  =     73.000 ...   457.999 secs
Ready.
	306 MEG channel locations transformed
Reading /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif ...
Opening raw data file /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif...
	Range : 73000 ... 457999  =     73.000 ...   457.999 secs
Ready.
Reading 73000 ... 457999  =     73.000 ...   457.999 secs... [done]
	306 MEG channel locations transformed
Reading /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif ...
Opening raw data file /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif...
	Range : 73000 ... 457999  =     73.000 ...   457.999 secs
Ready.
Warning: Could not obtain electrode locations automatically. 
	306 MEG channel locations transformed
Reading /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif ...
Opening raw data file /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif...
	Range : 73000 ... 457999  =     73.000 ...   457.999 secs
Ready.
Data type is missing or incorrect, assigning default.
creating layout from cfg.grad
creating layout for neuromag306 system
Reading 73000 ... 82722  =     73.000 ...    82.722 secs... [done]
Reading 82723 ... 92445  =     82.723 ...    92.445 secs... [done]
Reading 92446 ... 102168  =     92.446 ...   102.168 secs... [done]
Reading 102169 ... 111891  =    102.169 ...   111.891 secs... [done]
Reading 111892 ... 121614  =    111.892 ...   121.614 secs... [done]
Reading 121615 ... 131337  =    121.615 ...   131.337 secs... [done]
Reading 131338 ... 141060  =    131.338 ...   141.060 secs... [done]
Reading 141061 ... 150783  =    141.061 ...   150.783 secs... [done]
Reading 150784 ... 160506  =    150.784 ...   160.506 secs... [done]
Reading 160507 ... 170229  =    160.507 ...   170.229 secs... [done]
Reading 170230 ... 179952  =    170.230 ...   179.952 secs... [done]
Reading 179953 ... 189675  =    179.953 ...   189.675 secs... [done]
Reading 189676 ... 199398  =    189.676 ...   199.398 secs... [done]
Reading 199399 ... 209121  =    199.399 ...   209.121 secs... [done]
Reading 209122 ... 218844  =    209.122 ...   218.844 secs... [done]
Reading 218845 ... 228567  =    218.845 ...   228.567 secs... [done]
Reading 228568 ... 238290  =    228.568 ...   238.290 secs... [done]
Reading 238291 ... 248013  =    238.291 ...   248.013 secs... [done]
Reading 248014 ... 257736  =    248.014 ...   257.736 secs... [done]
Reading 257737 ... 267459  =    257.737 ...   267.459 secs... [done]
Reading 267460 ... 277182  =    267.460 ...   277.182 secs... [done]
Reading 277183 ... 286905  =    277.183 ...   286.905 secs... [done]
Reading 286906 ... 296628  =    286.906 ...   296.628 secs... [done]
Reading 296629 ... 306351  =    296.629 ...   306.351 secs... [done]
Reading 306352 ... 316074  =    306.352 ...   316.074 secs... [done]
Reading 316075 ... 325797  =    316.075 ...   325.797 secs... [done]
Reading 325798 ... 335520  =    325.798 ...   335.520 secs... [done]
Reading 335521 ... 345243  =    335.521 ...   345.243 secs... [done]
Reading 345244 ... 354966  =    345.244 ...   354.966 secs... [done]
Reading 354967 ... 364689  =    354.967 ...   364.689 secs... [done]
Reading 364690 ... 374412  =    364.690 ...   374.412 secs... [done]
Reading 374413 ... 384135  =    374.413 ...   384.135 secs... [done]
Reading 384136 ... 393858  =    384.136 ...   393.858 secs... [done]
Reading 393859 ... 403581  =    393.859 ...   403.581 secs... [done]
Reading 403582 ... 413304  =    403.582 ...   413.304 secs... [done]
Reading 413305 ... 423027  =    413.305 ...   423.027 secs... [done]
Reading 423028 ... 432750  =    423.028 ...   432.750 secs... [done]
Reading 432751 ... 442473  =    432.751 ...   442.473 secs... [done]
Reading 442474 ... 452196  =    442.474 ...   452.196 secs... [done]
Reading 452197 ... 457999  =    452.197 ...   457.999 secs... [done]
	306 MEG channel locations transformed
Reading /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif ...
Opening raw data file /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif...
	Range : 73000 ... 457999  =     73.000 ...   457.999 secs
Ready.
Warning: Could not obtain electrode locations automatically. 
	306 MEG channel locations transformed
Reading /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif ...
Opening raw data file /Applications/osl/example_data/preproc_example/automatic_opt/fifs/loc_S02_sss1.fif...
	Range : 73000 ... 457999  =     73.000 ...   457.999 secs
Ready.
Data type is missing or incorrect, assigning default.
creating layout from cfg.grad
creating layout for neuromag306 system
%%%%%%%%%%%%%%%%%%%%%%%  DOWNSAMP, SESS = 1  %%%%%%%%%%%%%%%%%%%%%%%

SPM12: spm_eeg_downsample (v6016)                  18:07:58 - 05/04/2017
========================================================================
%%%%%%%%%%%%%%%%%%%%%%%  PLOT SPECTOGRAMS, SESS = 1  %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%  EPOCH, SESS = 1  %%%%%%%%%%%%%%%%%%%%%%%

	SPM12: spm_eeg_definetrial (v6182)         18:08:28 - 05/04/2017
	----------------------------------------------------------------

SPM12: spm_eeg_epochs (v6183)                      18:08:29 - 05/04/2017
========================================================================
Data type is missing or incorrect, assigning default.
%%%%%%%%%%%%%%%%%%%%%%%  BAD CHAN/EVENTS, SESS = 1  %%%%%%%%%%%%%%%%%%%%%%%

SPM12: spm_eeg_copy (v5079)                        18:08:47 - 05/04/2017
========================================================================
Doing MEGMAG

ans =

    57    90

Doing MEGPLANAR
Already labelled bad chans=[57 90]

ans =

    57    90   271

Bad chans=[57 90 271]
Saving opt results for: session1
To view OPT report, point your browser to &lt;a href="/Applications/osl/example_data/preproc_example/automatic_opt/practical_badseg_africa.opt/plots/report.html"&gt;/Applications/osl/example_data/preproc_example/automatic_opt/practical_badseg_africa.opt/plots/report.html&lt;/a&gt;
</pre><h2 id="8">RESULTS</h2><pre class="codeinput">disp(<span class="string">'opt.results:'</span>);
disp(opt.results);
</pre><pre class="codeoutput">opt.results:
                       plotsdir: '/Applications/osl/example_data/preproc_e...'
                        logfile: '/Applications/osl/example_data/preproc_e...'
                           date: '05-Apr-2017'
                         fnames: {'session1'}
                      spm_files: {1x1 cell}
            spm_files_basenames: {'dspm_meg1'}
              spm_files_epoched: {1x1 cell}
    spm_files_epoched_basenames: {'Sedspm_meg1'}
                       badchans: 3
                   bad_segments: NaN
                       rejected: 68
                     autobadoff: NaN
                     icsremoved: NaN
               pre_sss_badchans: NaN
                      ica_files: {[]}
            spm_files_ica_input: {[]}
                         report: [1x1 struct]

</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2016a</a><br></p></div><!--
##### SOURCE BEGIN #####
%%%%%%%%%%%%%%%%%%
% This is a TEMPLATE script for running the OHBA recommended preprocessing
% pipeline on Elekta-Neuromag data (a very similar pipeline will work on
% CTF data as well) using OPT. It works through the following steps:
%
% You'll need to alter (at the very least) the settings in:
% datadir, fif_files, spm_files, structurals_files

%%%%%%%%%%%%%%%%%%
%% SETUP THE MATLAB PATHS
% make sure that fieldtrip and spm are not in your matlab path

OSLDIR = getenv('OSLDIR');
    
%osldir = '/Users/andrew/Software/Matlab/osl2.0';

%addpath(osldir);
osl_startup();

%%%%%%%%%%%%%%%%%%
%% INITIALISE GLOBAL SETTINGS FOR THIS ANALYSIS

% directory where the data is:
datadir = fullfile(osldir,'example_data','preproc_example','automatic_opt');
 

% Set up the list of subjects and their structural scans for the analysis 
clear raw_fif_files input_files spm_files structural_files;

% Specify a list of the existing raw fif files for subjects for input into
% Maxfilter.
% Note that here we only have 1 subject, but more generally there would be
% more than one, e.g.:
% raw_files{1}=[testdir '/fifs/sub1_face_sss']; 
% raw_files{2}=[testdir '/fifs/sub2_face_sss']; 
% etc...
% OR
% Specify a list of the input files to be converted into SPM
% Note that here we only have 1 subject, but more generally there would be
% more than one, e.g.:
% fif_files{1}=[testdir '/fifs/sub1_face_sss']; 
% fif_files{2}=[testdir '/fifs/sub2_face_sss']; 
% etc...

raw_fif_files{1}=[datadir '/fifs/loc_S02.fif']; 
input_files{1}=[datadir '/fifs/loc_S02_sss1.fif']; 
spm_files{1}=[datadir '/spm_files/loc_S02']; 

% Setup a list of existing structural files, in the same order as spm_files and fif_files:
% Note that here we only have 1 subject, but more generally there would be
% more than one.
structural_files{1}=[datadir '/structs/anat.nii']; % leave empty if no .nii structural file available

%%%%%%%%%%%%%%%%%%%%%%%%%
%% SETUP OPT

opt=[];

%%%%
% required inputs

%opt.raw_fif_files=raw_fif_files;
opt.input_files=input_files;
%opt.spm_files=spm_files;

opt.datatype='neuromag';

%%%%
% optional inputs

opt.dirname=[datadir '/practical_badseg_africa.opt']; % directory opt settings and results will be stored

% maxfilter settings
opt.maxfilter.do=0; % here we are going to skip the double maxfilter call as this has been run already for us
 
% africa settings
% RATHER NOT!!!!
opt.africa.do=0;
opt.africa.ident.artefact_chans={'ECG','EOG'}; % artefact channels
opt.africa.ident.mains_kurt_thresh=0.5;

% highpass filter settings
opt.highpass.do=0;

% bad segments settings
opt.bad_segments.do=0;

% Epoching settings
%
% Here the epochs are set to be from -1s to +2s relative to triggers
% in the MEG data.
opt.epoch.do=1;
opt.epoch.time_range = [-1 2]; % epoch end in secs   
opt.epoch.trialdef(1).conditionlabel = 'StimLRespL';
opt.epoch.trialdef(1).eventtype = 'STI101_down';
opt.epoch.trialdef(1).eventvalue = 11;
opt.epoch.trialdef(2).conditionlabel = 'StimLRespR';
opt.epoch.trialdef(2).eventtype = 'STI101_down';
opt.epoch.trialdef(2).eventvalue = 16;
opt.epoch.trialdef(3).conditionlabel = 'StimRRespL';
opt.epoch.trialdef(3).eventtype = 'STI101_down';
opt.epoch.trialdef(3).eventvalue = 21;
opt.epoch.trialdef(4).conditionlabel = 'StimRRespR';
opt.epoch.trialdef(4).eventtype = 'STI101_down';
opt.epoch.trialdef(4).eventvalue = 26;
opt.epoch.trialdef(5).conditionlabel = 'RespLRespL'; %L but
opt.epoch.trialdef(5).eventtype = 'STI101_down';
opt.epoch.trialdef(5).eventvalue = 13;
opt.epoch.trialdef(6).conditionlabel = 'RespLRespR';
opt.epoch.trialdef(6).eventtype = 'STI101_down';
opt.epoch.trialdef(6).eventvalue = 19;
opt.epoch.trialdef(7).conditionlabel = 'RespRRespL'; % L but press
opt.epoch.trialdef(7).eventtype = 'STI101_down';
opt.epoch.trialdef(7).eventvalue = 23;
opt.epoch.trialdef(8).conditionlabel = 'RespRRespR';
opt.epoch.trialdef(8).eventtype = 'STI101_down';
opt.epoch.trialdef(8).eventvalue = 29;

% coreg settings
opt.coreg.do=0; % not doing coreg here - although normally you would if you want to do subsequent analyses in source space 

% outliers settings
opt.outliers.do=1;

%%%%
% setup settings

opt=osl_check_opt(opt);

%%%%%%%%%%%%%%%%%%%%%%%%%
%% LOOK AT OPT SETTINGS

disp('opt settings:');
disp(opt);

%%%%%%%%%%%%%%%%%%%%%%%%%
%% LOOK AT OPT SUB-SETTINGS

disp('opt.maxfilter settings:');
disp(opt.maxfilter);

disp('opt.downsample settings:');
disp(opt.downsample);

disp('opt.africa settings:');
disp(opt.africa);

disp('opt.highpass settings:');
disp(opt.highpass);

disp('opt.epoch settings:');
disp(opt.epoch);

disp('opt.outliers settings:');
disp(opt.outliers);

disp('opt.coreg settings:');
disp(opt.coreg);

%%%%%%%%%%%%%%%%%%%%%%%%%
%% RUN OPT

opt=osl_run_opt(opt);

%%%%%%%%%%%%%%%%%%%%%%%%%
%% RESULTS

disp('opt.results:');
disp(opt.results);

##### SOURCE END #####
--></body></html>